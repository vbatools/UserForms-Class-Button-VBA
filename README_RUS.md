# clsButtonIcon - Класс двойной иконки-кнопки для VBA UserForms

![Project Demo](User_Forms.gif)

## Описание

`clsButtonIcon` - это класс VBA, который реализует интерактивную двойную иконку-кнопку для использования в Excel VBA UserForms. Класс управляет двумя элементами Label (внешним и внутренним), создавая уникальный визуальный элемент с возможностью изменения состояния и цвета при наведении курсора.

## Особенности

- **Двойная иконка**: Внешняя и внутренняя иконки, каждая со своим состоянием
- **Два состояния**: Поддержка активного и неактивного состояний с разными иконками и цветами
- **Эффект наведения**: Автоматическая подсветка при наведении курсора мыши
- **Гибкая настройка**: Возможность настройки цветов, размеров, иконок и поведения
- **События**: Поддержка события Click для реакции на действия пользователя

## Требования

- Microsoft Excel с поддержкой VBA
- Шрифт "Segoe MDL2 Assets" для отображения иконок (входит в состав Windows)

## Установка

1. Скопируйте файл `clsButtonIcon.cls` в ваш проект VBA
2. Импортируйте класс в редакторе VBA

## Использование

### Базовое использование

```vba
Dim myButton As New clsButtonIcon

' Инициализация кнопки
Call myButton.Initialize(Label1, _
    ChrW$(59962), _        ' Внешняя иконка (активное состояние)
    ChrW$(59963), _        ' Внешняя иконка (неактивное состояние)
    RGB(0, 120, 215), _    ' Цвет внешней иконки (неактивное состояние)
    RGB(255, 0, 0), _      ' Цвет внешней иконки (активное состояние)
    ChrW$(59145), _        ' Внутренняя иконка (активное состояние)
    ChrW$(60236), _        ' Внутренняя иконка (неактивное состояние)
    RGB(128, 0, 128), _    ' Цвет внутренней иконки (неактивное состояние)
    RGB(128, 0, 128), _    ' Цвет внутренней иконки (активное состояние)
    True, _                ' Начальное состояние
    True                   ' Включить эффект наведения
)
```

### Подписка на события

```vba
Private Sub myButton_Click(mLabelOut As MSForms.Label, mLabelIn As MSForms.Label, Value As Boolean)
    Debug.Print "Состояние кнопки: " & Value
End Sub
```

### Изменение свойств во время выполнения

```vba
' Изменить иконки
myButton.IconCodeOutOn = ChrW$(59145)
myButton.IconCodeOutOff = ChrW$(60236)

' Изменить цвета
myButton.ColorOutOn = RGB(0, 176, 80)
myButton.ColorOutOff = RGB(128, 128, 128)

' Изменить состояние
myButton.Value = Not myButton.Value

' Управление видимостью и доступностью
myButton.Visible = True
myButton.Enabled = True
```

## Свойства

| Свойство | Тип | Описание |
|----------|-----|----------|
| `IconCodeOutOn` | String | Иконка внешнего элемента в активном состоянии |
| `IconCodeOutOff` | String | Иконка внешнего элемента в неактивном состоянии |
| `IconCodeInOn` | String | Иконка внутреннего элемента в активном состоянии |
| `IconCodeInOff` | String | Иконка внутреннего элемента в неактивном состоянии |
| `ColorOutOn` | XlRgbColor | Цвет внешней иконки в активном состоянии |
| `ColorOutOff` | XlRgbColor | Цвет внешней иконки в неактивном состоянии |
| `ColorInOn` | XlRgbColor | Цвет внутренней иконки в активном состоянии |
| `ColorInOff` | XlRgbColor | Цвет внутренней иконки в неактивном состоянии |
| `SizeOut` | Single | Размер внешней иконки |
| `SizeIn` | Single | Размер внутренней иконки |
| `Value` | Boolean | Логическое состояние кнопки |
| `Visible` | Boolean | Видимость кнопки |
| `Enabled` | Boolean | Доступность кнопки |
| `HoverOn` | Boolean | Включение эффекта наведения |

## Методы

| Метод | Описание |
|-------|----------|
| `Initialize` | Инициализирует кнопку с заданными параметрами |
| `Version` | Возвращает информацию о версии класса |

## События

| Событие | Параметры | Описание |
|---------|-----------|----------|
| `Click` | `mLabelOut`, `mLabelIn`, `Value` | Возникает при клике на кнопку |

## Примеры

Пример использования представлен в форме `frmTestClass.frm`, которая демонстрирует все возможности класса.

Для запуска примера:
1. Откройте файл `button_v4.xlsm`
2. Запустите макрос `showForm` из модуля `modShowForms.bas`

## Обработка ошибок

Класс включает комплексную обработку ошибок:

- **Проверки инициализации**: Проверяет, что предоставленный элемент Label не равен Nothing и имеет родительскую форму
- **Проверка значений**: Обеспечивает, чтобы размеры были больше 0, а коды иконок не были пустыми
- **Подробные сообщения об ошибках**: Предоставляет конкретные описания ошибок для устранения неполадок

## Лицензия

Проект распространяется под лицензией Apache License 2.0. Подробности см. в файле LICENSE.

## Автор

VBATools